# kafka 

当前kafka版本为2.4.0   

##  ~~慎用apachecn.org~~  

建议不要图方便使用国内[中文网站](http://kafka.apachecn.org/quickstart.html),这个网站内容停留在1.0版本，
会导致客户端、服务端、文档等多头不一致问题，出现莫名其妙的问题；直接使用官方网站即可；  

##  `--bootstrap-server`指定域名出错却打印127.0.0.1的问题  

关于使用源码配置`config/server.properties`启动起来的服务，
在远端使用脚本客户端`./bin/kafka-topics.sh  --bootstrap-server  kafka.qidizi.com:9092  --list`连接,
出错时打印`127.0.0.1:9092`这种莫名问题，经过半天研究发现，它是受某配置影响：
如果服务端的`config/server.properties`没有指定`#advertised.listeners=PLAINTEXT://kafka.qidizi.com:9092`,在通过
`--bootstrap-server  kafka.qidizi.com:9092`连接时，返回的node地址将是`listeners=PLAINTEXT://10.10.10.10:9092`设置
解析出来的值，因为它的值是局域网的ip，肯定连接不上；但是使用弃用的`--zookeeper <String: hosts>  `指定却能正常使用；  
出错时的提示如下：   

```
[2020-02-28 17:12:32,429] WARN [AdminClient clientId=adminclient-1] Connection to node 0 (/10.10.10.10:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)
```  


## kafka的php扩展 

它叫rdkafka，通过pecl search kafka得到全名后，换成install指令安装即可，若出错，查看提示，可能是需要先安装librdkafka，若是mac，使用brew安装这个依赖库；
php扩展文档的在[这](https://arnaud.le-blanc.net/php-rdkafka-doc/phpdoc/book.rdkafka.html)，但是它的文档写得比较差，比如set的可用列表都没有提及，需要参考它的[依赖库的文档](https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md)，所以建议结合kafka文档、库文档、php扩展文档才能搞明白用法，建议先使用kafka的bin目录下带的sh脚本来测试搞明白之后再使用；  

